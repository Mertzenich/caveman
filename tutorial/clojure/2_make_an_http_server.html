<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  </head>
  <body style="max-width: 800px">
    <section>
      <a href="/"><img src="/caveman.jpg" width="100px" /></a>
    </section>

    <h1>Make an HTTP Server</h1>
    <ul>
      <li>
        <h2>
          Add a dependency to the <code>ring</code> library to your
          <code>deps.edn</code>
        </h2>
        <code>
          <pre>
{:paths ["src"]
 :deps {org.clojure/clojure {:mvn/version "1.12.0"}
        ring/ring {:mvn/version "1.13.0"}}}
           </pre
          >
        </code>

        <p>
          Ring is the library most everyone in the Clojure world uses for HTTP servers.
        </p>
      </li>
      <li>
        <h2>
          Edit your <code>src/example/main.clj</code> file so it has the following
          contents.
        </h2>
        <code>
          <pre>
(ns example.main
  (:require [ring.adapter.jetty :as jetty]))

(defn handler
  [request]
  {:status 200
   :headers {"Content-Type" "text/html"}
   :body "Hello, world"})

(defn -main []
  (jetty/run-jetty #'handler {:port 9999}))</pre
          >
        </code>

        <p>
          The <code>handler</code> function takes in an HTTP Request as outlined
          by
          <a href="https://github.com/ring-clojure/ring/blob/master/SPEC.md">
            The Ring Specification</a
          >
          and returns a map representing an HTTP Response.
        </p>

        <p>
          When we call <code>jetty/start-jetty</code> we give it that
          <code>handler</code> function. A small wrinkle is that little
          <code>#'</code> in front. That makes it so that if you reload that
          function in a <code>REPL</code> the server will use the new definition
          right away.
        </p>

        <p>
          For more details on how that works you can dig into
          <a href="https://clojure.org/reference/vars">Clojure Vars</a>. All you
          need to know is that when you want to pass a function as an argument
          and have it work with the <code>REPL</code>, you need to put
          <code>#'</code> in front.
        </p>
      </li>
      <li>
        <h2>Run the server with <code>just run</code></h2>
        <p>You should see a warning like the following. Ignore it for now.</p>
        <code>
          <pre>
SLF4J: No SLF4J providers were found.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See https://www.slf4j.org/codes.html#noProviders for further details.</pre
          >
        </code>
      </li>
      <li>
        <h2>
          Open your web browser and go to <code>http://localhost:9999</code>
        </h2>
          <p>You should see <code>Hello, world</code>.</p>
      </li>
    </ul>

    <section>
      <div>
        <h1>
          <a href="/tutorial/clojure/3_start_an_nrepl_server.html"
            >&rarr; Start an nREPL Server</a
          >
        </h1>
        <h1>
          <a href="/tutorial/clojure/1_create_a_project.html"
            >&larr; Create a Project</a
          >
        </h1>
      </div>
    </section>
  </body>
</html>
